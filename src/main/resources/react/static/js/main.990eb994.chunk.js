(this["webpackJsonphello-world"]=this["webpackJsonphello-world"]||[]).push([[0],{62:function(e,t,a){e.exports=a(91)},91:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(16),o=a.n(r),l=a(27),i=a(5),c=a(10),h=a(11),u=a(13),m=a(12),d=a(14),p=a(32),g=a.n(p),E=a(103),v=a(94),b=a(105),y=a(95),C=a(106),f=a(101),O=a(100),j=a(96),w=a(107),N=a(104),k=a(97),S=a(98),x=a(61),B=a(99),R=a(102),A=a(58),M=a.n(A),U=("localhost"===window.location.hostname?"http://":"https://")+window.location.hostname+":"+window.location.port+"/",J=new WebSocket(("localhost"===window.location.hostname?"ws://":"wss://")+window.location.hostname+":"+window.location.port+"/tofu");var L=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return s.a.createElement(E.a,{bg:"white",expand:"lg",style:{paddingRight:"30px"}},s.a.createElement(E.a.Brand,{href:"#home",style:{fontSize:"30px",fontWeight:"500"}},s.a.createElement(v.a,{alt:"logo",src:"image/logo.png",width:"40",height:"40",className:"d-inline-block align-center"}),"\xa0\xa0\xa0WashU Chat"),s.a.createElement(b.a,{className:"ml-auto align-center",style:{fontSize:"20px"}},s.a.createElement(b.a.Item,null,"User: ",this.props.username)))}}]),t}(s.a.Component),T=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleClick=a.handleClick.bind(Object(i.a)(a)),a}return Object(d.a)(t,e),Object(h.a)(t,[{key:"handleClick",value:function(e){"BUTTON"===e.target.tagName?this.props.switchUser(e.target.lastChild.id):this.props.switchUser(e.target.id),this.props.clearCount(this.props.group,this.props.username)}},{key:"showBadge",value:function(e){return void 0===e||0===e?s.a.createElement(s.a.Fragment,null):s.a.createElement(y.a,{variant:"secondary",style:{marginLeft:"10px"},id:this.props.group+"_"+this.props.username},e)}},{key:"render",value:function(){return s.a.createElement(C.a.Item,{action:!0,variant:"none",onClick:this.handleClick},s.a.createElement(v.a,{id:this.props.group+"_"+this.props.username,src:"image/"+this.props.role+".png",style:{height:"20px"}}),s.a.createElement("div",{className:"btn",id:this.props.group+"_"+this.props.username},this.props.username,this.showBadge(this.props.count)))}}]),t}(s.a.Component),I=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleBroadcast=a.handleBroadcast.bind(Object(i.a)(a)),a.handleLeave=a.handleLeave.bind(Object(i.a)(a)),a.handleJoin=a.handleJoin.bind(Object(i.a)(a)),a.handleClose=a.handleClose.bind(Object(i.a)(a)),a.handleCancel=a.handleCancel.bind(Object(i.a)(a)),a.handleJoinError=a.handleJoinError.bind(Object(i.a)(a)),a.handleSend=a.handleSend.bind(Object(i.a)(a)),a.handleChange=a.handleChange.bind(Object(i.a)(a)),a.state={message:"",broadcastError:"",showJoinError:!1,showBroadcastPanel:!1},a}return Object(d.a)(t,e),Object(h.a)(t,[{key:"handleBroadcast",value:function(){this.setState({showBroadcastPanel:!0})}},{key:"handleJoin",value:function(){g.a.post(U+"join",JSON.stringify({username:this.props.username,groupName:this.props.chatRoom.groupName}),this.handleJoinError)}},{key:"handleLeave",value:function(){g.a.post(U+"leave",JSON.stringify({username:this.props.username,groupName:this.props.chatRoom.groupName}))}},{key:"handleJoinError",value:function(e){403===JSON.parse(e).status&&this.setState({showJoinError:!0})}},{key:"handleClose",value:function(e){this.setState({showJoinError:!1})}},{key:"handleCancel",value:function(e){this.setState({showBroadcastPanel:!1})}},{key:"handleSend",value:function(e){""===this.state.message?this.setState({broadcastError:"Broadcast message cannot be empty."}):(this.setState({broadcastError:"",showBroadcastPanel:!1}),this.props.sendMessage(JSON.stringify({type:"all",groupName:this.props.chatRoom.groupName,sender:this.props.username,receiver:"",text:this.state.message})))}},{key:"handleChange",value:function(e){this.setState(Object(l.a)({},e.target.name,e.target.value))}},{key:"render",value:function(){return this.props.chatRoom.owner===this.props.username?s.a.createElement("div",{className:"btn float-right",style:{padding:"auto"}},s.a.createElement(v.a,{src:"image/broadcast.png",style:{height:"20px"},onClick:this.handleBroadcast}),s.a.createElement(f.a,{show:this.state.showBroadcastPanel,onHide:this.handleCancel},s.a.createElement(f.a.Header,{closeButton:!0},s.a.createElement(f.a.Title,null,"Broadcast")),s.a.createElement(f.a.Body,null,s.a.createElement(O.a,null,s.a.createElement(O.a.Group,{controlId:"broadcastMessage"},s.a.createElement(O.a.Control,{name:"message",value:this.state.message,as:"textarea",rows:"3",onChange:this.handleChange}),s.a.createElement(O.a.Text,{className:"text-muted"},this.state.broadcastError)))),s.a.createElement(f.a.Footer,null,s.a.createElement(j.a,{variant:"secondary",onClick:this.handleCancel},"Cancel"),s.a.createElement(j.a,{variant:"secondary",onClick:this.handleSend},"Send")))):function(e,t){for(var a=0;a<t.length;++a)if(t[a].username===e)return!0;return!1}(this.props.username,this.props.chatRoom.joinedUsers)?s.a.createElement("div",{className:"btn float-right",style:{padding:"auto"}},s.a.createElement(v.a,{src:"image/leave.png",style:{height:"20px"},onClick:this.handleLeave})):s.a.createElement("div",{className:"btn float-right",style:{padding:"auto"}},s.a.createElement(v.a,{src:"image/join.png",style:{height:"20px"},onClick:this.handleJoin}),s.a.createElement(f.a,{show:this.state.showJoinError,onHide:this.handleClose},s.a.createElement(f.a.Header,{closeButton:!0},s.a.createElement(f.a.Title,null,"Sorry")),s.a.createElement(f.a.Body,null,"You are not allowed to join this chat room due to restrictions."),s.a.createElement(f.a.Footer,null,s.a.createElement(j.a,{variant:"secondary",onClick:this.handleClose},"Close"))))}}]),t}(s.a.Component),H=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(h.a)(t,[{key:"listChatRoomMembers",value:function(){var e=this;return this.props.chatRoom.joinedUsers.filter((function(t){return t.username!==e.props.username})).map((function(t){return s.a.createElement(T,{key:e.props.chatRoom.groupName+"_"+t.username,count:void 0===e.props.count?void 0:e.props.count[t.username],switchUser:e.props.switchUser,clearCount:e.props.clearCount,group:e.props.chatRoom.groupName,username:t.username,role:t.username===e.props.chatRoom.owner?"admin":"user"})}))}},{key:"sumAll",value:function(e){for(var t=0,a=Object.values(e),n=0;n<a.length;++n)t+=a[n];return t}},{key:"showBadge",value:function(e){return void 0===e||0===this.sumAll(e)?s.a.createElement(s.a.Fragment,null):s.a.createElement(y.a,{variant:"secondary",style:{marginLeft:"10px"}},this.sumAll(e))}},{key:"render",value:function(){return s.a.createElement(w.a,null,s.a.createElement(N.a.Toggle,{as:w.a.Header,eventKey:this.props.id},s.a.createElement("div",{className:"btn",disabled:!0,style:{fontWeight:"500"}},this.props.chatRoom.groupName,this.showBadge(this.props.count)),s.a.createElement(I,{chatRoom:this.props.chatRoom,username:this.props.username,sendMessage:this.props.sendMessage})),s.a.createElement(N.a.Collapse,{eventKey:this.props.id},s.a.createElement(w.a.Body,null,s.a.createElement(C.a,{variant:"flush"},this.listChatRoomMembers()))))}}]),t}(s.a.Component),P=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleOpen=a.handleOpen.bind(Object(i.a)(a)),a.handleClose=a.handleClose.bind(Object(i.a)(a)),a.handleChange=a.handleChange.bind(Object(i.a)(a)),a.handleCreate=a.handleCreate.bind(Object(i.a)(a)),a.handleResponse=a.handleResponse.bind(Object(i.a)(a)),a.state={showCreatePanel:!1,groupName:"",minAge:"",maxAge:"",region:["na"],school:["washu"],groupNameError:"",ageError:"",regionError:"",schoolError:"",createChatRoomError:""},a}return Object(d.a)(t,e),Object(h.a)(t,[{key:"handleChange",value:function(e){if("region"===e.target.name||"school"===e.target.name){for(var t=e.target.options,a=[],n=0;n<t.length;++n)t[n].selected&&a.push(t[n].value);this.setState(Object(l.a)({},e.target.name,a))}else this.setState(Object(l.a)({},e.target.name,e.target.value))}},{key:"handleCreate",value:function(e){if(/^[0-9a-zA-Z]+$/.test(this.state.groupName)){this.setState({groupNameError:""});var t=parseInt(this.state.minAge),a=parseInt(this.state.maxAge);if(isNaN(t)||isNaN(a)||t<0||a<0)this.setState({ageError:"Age must be an integer no less than 0"});else{this.setState({ageError:""}),0===this.state.region.length?this.setState({regionError:"Must select at least 1 region"}):this.setState({regionError:""}),0===this.state.school.length?this.setState({schoolError:"Must select at least 1 school"}):this.setState({schoolError:""});var n={groupName:this.state.groupName,owner:this.props.username,minAge:this.state.minAge,maxAge:this.state.maxAge,locations:this.state.region,schools:this.state.school};g.a.post(U+"create",JSON.stringify(n),this.handleResponse)}}else this.setState({groupNameError:"Only letters and numbers are allowed"})}},{key:"handleResponse",value:function(e){200===JSON.parse(e).status?this.setState({showCreatePanel:!1,createChatRoomError:""}):this.setState({showCreatePanel:!0,createChatRoomError:"Chat room name already used. Please choose another one."})}},{key:"showAlert",value:function(e){if(""!==e)return s.a.createElement(k.a,{variant:"danger"},e)}},{key:"handleOpen",value:function(){this.setState({showCreatePanel:!0})}},{key:"handleClose",value:function(){this.setState({showCreatePanel:!1})}},{key:"listRooms",value:function(){var e=this,t=0;return this.props.list.owner.concat(this.props.list.member,this.props.list.other).map((function(a){return s.a.createElement(H,{key:a.groupName,id:t++,count:e.props.count[a.groupName],chatRoom:a,username:e.props.username,switchUser:e.props.switchUser,clearCount:e.props.clearCount,sendMessage:e.props.sendMessage})}))}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement(S.a,null,s.a.createElement(x.a,null,s.a.createElement(j.a,{variant:"outline-secondary",size:"lg",block:!0,style:{marginBottom:"20px"},onClick:this.handleOpen},"Create Chat Room"),s.a.createElement(f.a,{size:"md","aria-labelledby":"contained-modal-title-vcenter",centered:!0,show:this.state.showCreatePanel,onHide:this.handleClose},s.a.createElement(f.a.Header,{closeButton:!0},s.a.createElement(f.a.Title,{id:"contained-modal-title-vcenter"},"Create Chat Room")),s.a.createElement(f.a.Body,null,s.a.createElement(O.a,null,s.a.createElement(O.a.Group,{controlId:"groupName"},s.a.createElement(O.a.Label,null,"Chat Room Name"),s.a.createElement(O.a.Control,{name:"groupName",type:"text",placeholder:"Choose your chat room name",value:this.state.groupName,onChange:this.handleChange}),s.a.createElement(O.a.Text,{className:"text-muted"},this.state.groupNameError)),s.a.createElement(O.a.Row,null,s.a.createElement(O.a.Group,{as:x.a,controlId:"age"},s.a.createElement(O.a.Label,null,"Min Age"),s.a.createElement(O.a.Control,{name:"minAge",type:"text",placeholder:"Enter min age",value:this.state.minAge,onChange:this.handleChange}),s.a.createElement(O.a.Text,{className:"text-muted"},this.state.ageError)),s.a.createElement(O.a.Group,{as:x.a,controlId:"age"},s.a.createElement(O.a.Label,null,"Max Age"),s.a.createElement(O.a.Control,{name:"maxAge",type:"text",placeholder:"Enter max age",value:this.state.maxAge,onChange:this.handleChange}))),s.a.createElement(O.a.Group,{controlId:"region"},s.a.createElement(O.a.Label,null,"Region"),s.a.createElement(O.a.Control,{name:"region",as:"select",value:this.state.region,onChange:this.handleChange,multiple:!0},s.a.createElement("option",{value:"na"},"NA"),s.a.createElement("option",{value:"as"},"AS"),s.a.createElement("option",{value:"eu"},"EU"),s.a.createElement("option",{vlaue:"sa"},"SA"),s.a.createElement("option",{value:"oa"},"OA"),s.a.createElement("option",{value:"af"},"AF")),s.a.createElement(O.a.Text,{className:"text-muted"},this.state.regionError)),s.a.createElement(O.a.Group,{controlId:"school"},s.a.createElement(O.a.Label,null,"School"),s.a.createElement(O.a.Control,{name:"school",as:"select",value:this.state.school,onChange:this.handleChange,multiple:!0},s.a.createElement("option",{value:"washu"},"WashU"),s.a.createElement("option",{value:"ucb"},"UCB"),s.a.createElement("option",{value:"uiuc"},"UIUC"),s.a.createElement("option",{value:"nyu"},"NYU")),s.a.createElement(O.a.Text,{className:"text-muted"},this.state.schoolError)),this.showAlert(this.state.createChatRoomError))),s.a.createElement(f.a.Footer,null,s.a.createElement(j.a,{variant:"secondary",onClick:this.handleCreate},"Create"))))),s.a.createElement(S.a,null,s.a.createElement(x.a,null,s.a.createElement(N.a,{style:{marginBottom:"20px"}},this.listRooms()))))}}]),t}(s.a.Component),F=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(h.a)(t,[{key:"listDialogs",value:function(){var e=this,t=0;return this.props.chat.map((function(a){return a.user===e.props.username?s.a.createElement(S.a,{key:t++},s.a.createElement(x.a,null,s.a.createElement("div",{className:"float-right"},s.a.createElement(w.a,{style:{marginBottom:"20px"}},s.a.createElement(w.a.Body,{style:{paddingTop:"10px",paddingBottom:"10px"}},a.text))))):s.a.createElement(S.a,{key:t++},s.a.createElement(x.a,null,s.a.createElement("div",{className:"float-left"},s.a.createElement(w.a,{style:{marginBottom:"20px"}},s.a.createElement(w.a.Body,{style:{paddingTop:"10px",paddingBottom:"10px"}},a.text)))))}))}},{key:"render",value:function(){return s.a.createElement(B.a,{style:{margin:"0",width:"auto",maxWidth:"none"}},this.listDialogs())}}]),t}(s.a.Component),_=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleChange=a.handleChange.bind(Object(i.a)(a)),a.handleSend=a.handleSend.bind(Object(i.a)(a)),a.state={message:"",messageError:""},a}return Object(d.a)(t,e),Object(h.a)(t,[{key:"handleChange",value:function(e){this.setState(Object(l.a)({},e.target.name,e.target.value))}},{key:"handleSend",value:function(){if(""===this.state.message)this.setState({messageError:"Message cannot be empty"});else{this.setState({message:"",messageError:""});var e={type:"one",groupName:this.props.group,sender:this.props.username,receiver:this.props.user,text:this.state.message};this.props.sendMessage(JSON.stringify(e)),this.props.addMessage(e)}}},{key:"render",value:function(){return""===this.props.user?s.a.createElement(s.a.Fragment,null):s.a.createElement(w.a,{style:{height:"80vh"}},s.a.createElement(w.a.Header,null,"Room: "+this.props.group+" / User: "+this.props.user),s.a.createElement(w.a.Body,null,s.a.createElement(M.a,{width:"100%",height:"100%",frameBorder:"no",style:{overflow:"hidden"},initialContent:'<!DOCTYPE html><html><head><link rel="stylesheet"\nhref="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"\nintegrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"\ncrossorigin="anonymous"\n/><style>body::-webkit-scrollbar{display:none}</style>\n</head><body><div></div></body></html>'},s.a.createElement(F,{chat:this.props.chat,username:this.props.username}))),s.a.createElement(w.a.Footer,{className:"text-right"},s.a.createElement(O.a,null,s.a.createElement(O.a.Group,null,s.a.createElement(O.a.Control,{as:"textarea",rows:"3",name:"message",value:this.state.message,onChange:this.handleChange}),s.a.createElement(O.a.Text,{className:"text-muted"},this.state.messageError)),s.a.createElement(j.a,{variant:"secondary",onClick:this.handleSend},"Send"))))}}]),t}(s.a.Component),G=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(h.a)(t,[{key:"showHeader",value:function(e){return"all"===e.type?"Group "+e.sender+" Broadcast":"system"===e.type?"System Notification":void 0}},{key:"render",value:function(){var e=this.props.note.length;return 0===e?s.a.createElement(s.a.Fragment,null):s.a.createElement("div",{style:{position:"absolute",right:"30px",top:"30px"}},s.a.createElement(R.a,{autohide:!0,delay:5e3,onClose:this.props.handleClose,show:this.props.show},s.a.createElement(R.a.Header,null,s.a.createElement("strong",{className:"mr-auto"},this.showHeader(this.props.note[e-1]))),s.a.createElement(R.a.Body,null,this.props.note[e-1].text)))}}]),t}(s.a.Component),W=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleChange=a.handleChange.bind(Object(i.a)(a)),a.handleRegister=a.handleRegister.bind(Object(i.a)(a)),a.state={username:"",age:"",region:"na",school:"washu",usernameError:"",ageError:""},a}return Object(d.a)(t,e),Object(h.a)(t,[{key:"handleChange",value:function(e){this.setState(Object(l.a)({},e.target.name,e.target.value))}},{key:"handleRegister",value:function(e){if(/^[0-9a-zA-Z]+$/.test(this.state.username)){this.setState({usernameError:""});var t=parseInt(this.state.age);if(isNaN(t)||t<=0)this.setState({ageError:"Age must be an integer greater than 0"});else{this.setState({ageError:""});var a={type:"register",groupName:"",sender:this.state.username,receiver:"",text:JSON.stringify({username:this.state.username,age:this.state.age,location:this.state.region,school:this.state.school})};this.props.sendMessage(JSON.stringify(a))}}else this.setState({usernameError:"Only letters and numbers are allowed"})}},{key:"showAlert",value:function(e){if(""!==e)return s.a.createElement(k.a,{variant:"danger"},e)}},{key:"render",value:function(){return s.a.createElement(f.a,{size:"md","aria-labelledby":"contained-modal-title-vcenter",centered:!0,show:!this.props.registered},s.a.createElement(f.a.Header,null,s.a.createElement(f.a.Title,{id:"contained-modal-title-vcenter"},"Register")),s.a.createElement(f.a.Body,null,s.a.createElement(O.a,null,s.a.createElement(O.a.Group,{controlId:"username"},s.a.createElement(O.a.Label,null,"Username"),s.a.createElement(O.a.Control,{name:"username",type:"text",placeholder:"Choose your username",value:this.state.username,onChange:this.handleChange}),s.a.createElement(O.a.Text,{className:"text-muted"},this.state.usernameError)),s.a.createElement(O.a.Group,{controlId:"age"},s.a.createElement(O.a.Label,null,"Age"),s.a.createElement(O.a.Control,{name:"age",type:"text",placeholder:"Enter your age",value:this.state.age,onChange:this.handleChange}),s.a.createElement(O.a.Text,{className:"text-muted"},this.state.ageError)),s.a.createElement(O.a.Group,{controlId:"region"},s.a.createElement(O.a.Label,null,"Region"),s.a.createElement(O.a.Control,{name:"region",as:"select",value:this.state.region,onChange:this.handleChange},s.a.createElement("option",{value:"na"},"NA"),s.a.createElement("option",{value:"as"},"AS"),s.a.createElement("option",{value:"eu"},"EU"),s.a.createElement("option",{vlaue:"sa"},"SA"),s.a.createElement("option",{value:"oa"},"OA"),s.a.createElement("option",{value:"af"},"AF"))),s.a.createElement(O.a.Group,{controlId:"school"},s.a.createElement(O.a.Label,null,"School"),s.a.createElement(O.a.Control,{name:"school",as:"select",value:this.state.school,onChange:this.handleChange},s.a.createElement("option",{value:"washu"},"WashU"),s.a.createElement("option",{value:"ucb"},"UCB"),s.a.createElement("option",{value:"uiuc"},"UIUC"),s.a.createElement("option",{value:"nyu"},"NYU"))),this.showAlert(this.props.registerError))),s.a.createElement(f.a.Footer,null,s.a.createElement(j.a,{variant:"secondary",onClick:this.handleRegister},"Register")))}}]),t}(s.a.Component),z=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return s.a.createElement(f.a,{show:this.props.show,onHide:this.props.handleClose},s.a.createElement(f.a.Header,{closeButton:!0},s.a.createElement(f.a.Title,null,"Sorry")),s.a.createElement(f.a.Body,null,"You have to join the chat room before chatting with members"),s.a.createElement(f.a.Footer,null,s.a.createElement(j.a,{variant:"secondary",onClick:this.props.handleClose},"Close")))}}]),t}(s.a.Component),Y=function(e){function t(e){var a;return Object(c.a)(this,t),a=Object(u.a)(this,Object(m.a)(t).call(this,e)),J.onmessage=function(e){return a.onMessage(e)},a.switchUser=a.switchUser.bind(Object(i.a)(a)),a.updateList=a.updateList.bind(Object(i.a)(a)),a.getList=a.getList.bind(Object(i.a)(a)),a.sendMessage=a.sendMessage.bind(Object(i.a)(a)),a.addMessage=a.addMessage.bind(Object(i.a)(a)),a.clearCount=a.clearCount.bind(Object(i.a)(a)),a.handleNoteClose=a.handleNoteClose.bind(Object(i.a)(a)),a.handleAccessErrClose=a.handleAccessErrClose.bind(Object(i.a)(a)),a.state={list:{owner:[],member:[],other:[]},chat:{_:[]},note:[],count:{},group:"",user:"",registered:!1,registerError:"",accessError:!1,username:"",notification:!1},a}return Object(d.a)(t,e),Object(h.a)(t,[{key:"updateList",value:function(e){var t=this;e=JSON.parse(e),this.setState({list:e});var a=e.owner.concat(e.member,e.other).filter((function(e){return e.groupName===t.state.group}));0!==a.length&&0!==a[0].joinedUsers.filter((function(e){return e.username===t.state.user})).length&&0!==a[0].joinedUsers.filter((function(e){return e.username===t.state.username})).length||this.setState({group:"",user:""})}},{key:"getList",value:function(){g.a.post(U+"list",JSON.stringify({username:this.state.username}),this.updateList)}},{key:"onMessage",value:function(e){var t=JSON.parse(e.data);if("ping"===t.type)console.log("keep connection alive");else if("register"===t.type)"success"===t.text?(this.setState({username:t.receiver,registered:!0}),this.getList()):"conflict"===t.text&&this.setState({registerError:"Username conflict. Please use another one."});else if("one"===t.type){this.addMessage(t);var a=this.state.count;this.state.user!==t.sender&&(void 0===a[t.groupName]?a[t.groupName]=Object(l.a)({},t.sender,1):void 0===a[t.groupName][t.sender]?a[t.groupName][t.sender]=1:a[t.groupName][t.sender]+=1),this.setState({count:a})}else this.addNotification(t)}},{key:"addMessage",value:function(e){var t=this.state.chat;e.sender===this.state.username&&void 0===t[e.groupName+"_"+e.receiver]?t[e.groupName+"_"+e.receiver]=[{user:e.sender,text:e.text}]:e.receiver===this.state.username&&void 0===t[e.groupName+"_"+e.sender]?t[e.groupName+"_"+e.sender]=[{user:e.sender,text:e.text}]:e.sender===this.state.username?t[e.groupName+"_"+e.receiver].push({user:e.sender,text:e.text}):e.receiver===this.state.username&&t[e.groupName+"_"+e.sender].push({user:e.sender,text:e.text}),this.setState({chat:t})}},{key:"addNotification",value:function(e){var t=this.state.note;t.push(e),this.setState({note:t,notification:!0}),this.getList()}},{key:"switchUser",value:function(e){for(var t=e.split("_"),a=this.state.list.other,n=0;n<a.length;++n)if(a[n].groupName===t[0])return void this.setState({accessError:!0});var s=this.state.chat;void 0===s[e]&&(s[e]=[]),this.setState({group:t[0],user:t[1],chat:s})}},{key:"sendMessage",value:function(e){""!==e&&J.send(e),"one"===(e=JSON.parse(e)).type&&this.addNotification({type:"system",groupName:e.groupName,sender:e.sender,receiver:e.receiver,text:"Message delivered"})}},{key:"clearCount",value:function(e,t){var a=this.state.count;void 0!==a[e]&&void 0!==a[e][t]&&(a[e][t]=0),this.setState({count:a})}},{key:"handleNoteClose",value:function(){this.setState({notification:!1})}},{key:"handleAccessErrClose",value:function(){this.setState({accessError:!1})}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(L,{username:this.state.username}),s.a.createElement(B.a,{style:{margin:"0",width:"auto",maxWidth:"none"}},s.a.createElement(S.a,{style:{margin:"0"}},s.a.createElement(x.a,{md:3},s.a.createElement(P,{list:this.state.list,count:this.state.count,username:this.state.username,switchUser:this.switchUser,clearCount:this.clearCount,sendMessage:this.sendMessage})),s.a.createElement(x.a,{md:9},s.a.createElement(_,{chat:this.state.chat[this.state.group+"_"+this.state.user],user:this.state.user,group:this.state.group,username:this.state.username,sendMessage:this.sendMessage,addMessage:this.addMessage})))),s.a.createElement(G,{note:this.state.note,show:this.state.notification,handleClose:this.handleNoteClose}),s.a.createElement(W,{registered:this.state.registered,registerError:this.state.registerError,sendMessage:this.sendMessage}),s.a.createElement(z,{show:this.state.accessError,handleClose:this.handleAccessErrClose}))}}]),t}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(90);o.a.render(s.a.createElement(Y,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[62,1,2]]]);
//# sourceMappingURL=main.990eb994.chunk.js.map